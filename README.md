# Webç‰ˆ å‹•ç”»10åˆ†åˆ†å‰²ãƒ„ãƒ¼ãƒ«

## 1. WBS (Work Breakdown Structure)

### ãƒ•ã‚§ãƒ¼ã‚º1: è¨ˆç”»ãƒ»è¨­è¨ˆ (2-3æ—¥)
- **1.1 è¦ä»¶åˆ†æ**
  - 1.1.1 æ©Ÿèƒ½è¦ä»¶ã®è©³ç´°åŒ–
  - 1.1.2 éæ©Ÿèƒ½è¦ä»¶ã®è©³ç´°åŒ–
  - 1.1.3 æŠ€è¡“åˆ¶ç´„ã®ç¢ºèª
- **1.2 ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ**
  - 1.2.1 ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³ä½œæˆ
  - 1.2.2 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ
  - 1.2.3 APIä»•æ§˜æ›¸ä½œæˆ
- **1.3 UI/UXè¨­è¨ˆ**
  - 1.3.1 ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ
  - 1.3.2 ç”»é¢é·ç§»å›³ä½œæˆ
  - 1.3.3 ãƒ‡ã‚¶ã‚¤ãƒ³ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ç­–å®š

### ãƒ•ã‚§ãƒ¼ã‚º2: é–‹ç™ºãƒ»å®Ÿè£… (5-7æ—¥)
- **2.1 ç’°å¢ƒæ§‹ç¯‰**
  - 2.1.1 é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
  - 2.1.2 ä¾å­˜é–¢ä¿‚ç®¡ç†
  - 2.1.3 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ä½œæˆ
- **2.2 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™º**
  - 2.2.1 Flaskã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åŸºç›¤æ§‹ç¯‰
  - 2.2.2 ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½å®Ÿè£…
  - 2.2.3 å‹•ç”»åˆ†å‰²å‡¦ç†å®Ÿè£…ï¼ˆMoviePyä½¿ç”¨ï¼‰
  - 2.2.4 ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½å®Ÿè£…
  - 2.2.5 è‡ªå‹•å‰Šé™¤æ©Ÿèƒ½å®Ÿè£…
  - 2.2.6 ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å®Ÿè£…
- **2.3 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™º**
  - 2.3.1 HTMLãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
  - 2.3.2 CSS ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°
  - 2.3.3 JavaScript ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œå®Ÿè£…
  - 2.3.4 ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼å®Ÿè£…
  - 2.3.5 éåŒæœŸé€šä¿¡å®Ÿè£…ï¼ˆAjaxï¼‰
- **2.4 çµ±åˆãƒ»é€£æº**
  - 2.4.1 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ»ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰çµ±åˆ
  - 2.4.2 å‹•ç”»å‡¦ç†ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
  - 2.4.3 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–å®Ÿè£…

### ãƒ•ã‚§ãƒ¼ã‚º3: ãƒ†ã‚¹ãƒˆ (2-3æ—¥)
- **3.1 å˜ä½“ãƒ†ã‚¹ãƒˆ**
  - 3.1.1 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å˜ä½“ãƒ†ã‚¹ãƒˆ
  - 3.1.2 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å˜ä½“ãƒ†ã‚¹ãƒˆ
- **3.2 çµåˆãƒ†ã‚¹ãƒˆ**
  - 3.2.1 APIçµåˆãƒ†ã‚¹ãƒˆ
  - 3.2.2 E2Eãƒ†ã‚¹ãƒˆ
- **3.3 éæ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ**
  - 3.3.1 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
  - 3.3.2 è² è·ãƒ†ã‚¹ãƒˆ
  - 3.3.3 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ
- **3.4 ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆ**
  - 3.4.1 æ“ä½œæ€§ç¢ºèª
  - 3.4.2 ãƒ–ãƒ©ã‚¦ã‚¶äº’æ›æ€§ãƒ†ã‚¹ãƒˆ

### ãƒ•ã‚§ãƒ¼ã‚º4: ãƒªãƒªãƒ¼ã‚¹ãƒ»é‹ç”¨ (1-2æ—¥)
- **4.1 ãƒ‡ãƒ—ãƒ­ã‚¤æº–å‚™**
  - 4.1.1 æœ¬ç•ªç’°å¢ƒè¨­å®š
  - 4.1.2 ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
- **4.2 ãƒªãƒªãƒ¼ã‚¹**
  - 4.2.1 æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤
  - 4.2.2 å‹•ä½œç¢ºèª
- **4.3 é‹ç”¨æº–å‚™**
  - 4.3.1 ç›£è¦–è¨­å®š
  - 4.3.2 ãƒ­ã‚°è¨­å®š
  - 4.3.3 ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š

## 2. ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```mermaid
graph TD
    A[ãƒ¦ãƒ¼ã‚¶ãƒ¼] --> B[Webãƒ–ãƒ©ã‚¦ã‚¶]
    B --> C[ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰<br/>HTML/CSS/JavaScript]
    C --> D[Flask Webã‚µãƒ¼ãƒãƒ¼]
    D --> E[ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ<br/>/upload]
    D --> F[ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ<br/>/files]
    D --> G[ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ<br/>/download]
    E --> H[ä¸€æ™‚ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸<br/>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«]
    H --> I[MoviePy<br/>å‹•ç”»åˆ†å‰²å‡¦ç†]
    I --> J[ä¸€æ™‚ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸<br/>åˆ†å‰²æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«]
    F --> J
    G --> J
    J --> K[è‡ªå‹•å‰Šé™¤å‡¦ç†<br/>24æ™‚é–“å¾Œ]
    
    style A fill:#e1f5fe
    style C fill:#f3e5f5
    style D fill:#e8f5e8
    style I fill:#fff3e0
```

## 3. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£… (Flask)

```python
import os
import uuid
import zipfile
from datetime import datetime, timedelta
from flask import Flask, request, jsonify, send_file, render_template
from werkzeug.utils import secure_filename
from moviepy.editor import VideoFileClip
import threading
import time
import shutil

app = Flask(__name__)
app.config['MAX_CONTENT_LENGTH'] = 2 * 1024 * 1024 * 1024  # 2GBåˆ¶é™
app.config['UPLOAD_FOLDER'] = 'uploads'
app.config['OUTPUT_FOLDER'] = 'outputs'

# ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ
os.makedirs(app.config['UPLOAD_FOLDER'], exist_ok=True)
os.makedirs(app.config['OUTPUT_FOLDER'], exist_ok=True)

# å‡¦ç†çŠ¶æ³ã‚’ç®¡ç†ã™ã‚‹è¾æ›¸
processing_status = {}

ALLOWED_EXTENSIONS = {'mp4', 'mov', 'avi'}

def allowed_file(filename):
    return '.' in filename and filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS

def split_video(input_path, output_folder, session_id):
    """å‹•ç”»ã‚’10åˆ†ã”ã¨ã«åˆ†å‰²ã™ã‚‹"""
    try:
        processing_status[session_id]['status'] = 'processing'
        processing_status[session_id]['progress'] = 0
        
        # å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
        video = VideoFileClip(input_path)
        duration = video.duration
        segment_duration = 600  # 10åˆ† = 600ç§’
        
        segments = []
        segment_count = int(duration // segment_duration) + (1 if duration % segment_duration > 0 else 0)
        
        for i in range(segment_count):
            start_time = i * segment_duration
            end_time = min((i + 1) * segment_duration, duration)
            
            # åˆ†å‰²ã•ã‚ŒãŸå‹•ç”»ã‚’ä½œæˆ
            segment = video.subclip(start_time, end_time)
            segment_filename = f"segment_{i+1:03d}.mp4"
            segment_path = os.path.join(output_folder, segment_filename)
            
            segment.write_videofile(segment_path, codec='libx264', audio_codec='aac')
            segments.append(segment_filename)
            
            # é€²æ—æ›´æ–°
            progress = int(((i + 1) / segment_count) * 100)
            processing_status[session_id]['progress'] = progress
            
            segment.close()
        
        video.close()
        
        # å‡¦ç†å®Œäº†
        processing_status[session_id]['status'] = 'completed'
        processing_status[session_id]['segments'] = segments
        processing_status[session_id]['completed_at'] = datetime.now()
        
        # è‡ªå‹•å‰Šé™¤ã‚¿ã‚¤ãƒãƒ¼è¨­å®šï¼ˆ24æ™‚é–“å¾Œï¼‰
        timer = threading.Timer(24 * 3600, cleanup_files, args=[session_id])
        timer.start()
        
    except Exception as e:
        processing_status[session_id]['status'] = 'error'
        processing_status[session_id]['error'] = str(e)

def cleanup_files(session_id):
    """ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è‡ªå‹•å‰Šé™¤ã™ã‚‹"""
    if session_id in processing_status:
        output_folder = os.path.join(app.config['OUTPUT_FOLDER'], session_id)
        if os.path.exists(output_folder):
            shutil.rmtree(output_folder)
        del processing_status[session_id]

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/upload', methods=['POST'])
def upload_file():
    if 'file' not in request.files:
        return jsonify({'error': 'ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“'}), 400
    
    file = request.files['file']
    if file.filename == '':
        return jsonify({'error': 'ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚Œã¦ã„ã¾ã›ã‚“'}), 400
    
    if file and allowed_file(file.filename):
        # ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ç”Ÿæˆ
        session_id = str(uuid.uuid4())
        
        # ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
        filename = secure_filename(file.filename)
        upload_path = os.path.join(app.config['UPLOAD_FOLDER'], f"{session_id}_{filename}")
        file.save(upload_path)
        
        # å‡ºåŠ›ãƒ•ã‚©ãƒ«ãƒ€ä½œæˆ
        output_folder = os.path.join(app.config['OUTPUT_FOLDER'], session_id)
        os.makedirs(output_folder, exist_ok=True)
        
        # å‡¦ç†çŠ¶æ³åˆæœŸåŒ–
        processing_status[session_id] = {
            'status': 'uploading',
            'progress': 0,
            'segments': [],
            'uploaded_at': datetime.now()
        }
        
        # ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§åˆ†å‰²å‡¦ç†é–‹å§‹
        thread = threading.Thread(target=split_video, args=[upload_path, output_folder, session_id])
        thread.start()
        
        return jsonify({'session_id': session_id}), 200
    
    return jsonify({'error': 'å¯¾å¿œã—ã¦ã„ãªã„ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã§ã™'}), 400

@app.route('/status/<session_id>')
def get_status(session_id):
    if session_id in processing_status:
        return jsonify(processing_status[session_id])
    return jsonify({'error': 'ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“'}), 404

@app.route('/files/<session_id>')
def get_files(session_id):
    if session_id in processing_status and processing_status[session_id]['status'] == 'completed':
        return jsonify({
            'files': processing_status[session_id]['segments'],
            'session_id': session_id
        })
    return jsonify({'error': 'ãƒ•ã‚¡ã‚¤ãƒ«ã®æº–å‚™ãŒã§ãã¦ã„ã¾ã›ã‚“'}), 404

@app.route('/download/<session_id>/<filename>')
def download_file(session_id, filename):
    file_path = os.path.join(app.config['OUTPUT_FOLDER'], session_id, filename)
    if os.path.exists(file_path):
        return send_file(file_path, as_attachment=True)
    return jsonify({'error': 'ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“'}), 404

@app.route('/download_zip/<session_id>')
def download_zip(session_id):
    if session_id in processing_status and processing_status[session_id]['status'] == 'completed':
        output_folder = os.path.join(app.config['OUTPUT_FOLDER'], session_id)
        zip_path = f"{output_folder}.zip"
        
        with zipfile.ZipFile(zip_path, 'w') as zipf:
            for filename in processing_status[session_id]['segments']:
                file_path = os.path.join(output_folder, filename)
                zipf.write(file_path, filename)
        
        return send_file(zip_path, as_attachment=True, download_name=f"split_videos_{session_id}.zip")
    
    return jsonify({'error': 'ãƒ•ã‚¡ã‚¤ãƒ«ã®æº–å‚™ãŒã§ãã¦ã„ã¾ã›ã‚“'}), 404

if __name__ == '__main__':
    app.run(debug=True)
```

## 4. ç°¡å˜ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

### Railway ã§ã®ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆæ¨å¥¨ï¼‰

[![Deploy on Railway](https://railway.app/button.svg)](https://railway.app/new/template?template=https%3A%2F%2Fgithub.com%2Fyaoo77%2Fvideo-splitter-app)

1. ä¸Šã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
2. GitHubã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³
3. ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†ã¾ã§æ•°åˆ†å¾…æ©Ÿ
4. æä¾›ã•ã‚ŒãŸURLã«ã‚¢ã‚¯ã‚»ã‚¹

### ãã®ä»–ã®ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•

è©³ç´°ãªæ‰‹é †ã¯ [DEPLOYMENT.md](DEPLOYMENT.md) ã‚’ã”è¦§ãã ã•ã„ã€‚

## 5. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£… (HTML/JavaScript)

```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‹•ç”»10åˆ†åˆ†å‰²ãƒ„ãƒ¼ãƒ«</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .upload-section {
            margin-bottom: 30px;
            text-align: center;
        }
        
        .file-input-wrapper {
            position: relative;
            display: inline-block;
            margin-bottom: 20px;
        }
        
        .file-input {
            position: absolute;
            left: -9999px;
        }
        
        .file-input-label {
            display: inline-block;
            padding: 12px 24px;
            background-color: #007bff;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .file-input-label:hover {
            background-color: #0056b3;
        }
        
        .upload-button {
            display: inline-block;
            padding: 12px 30px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-left: 10px;
            transition: background-color 0.3s;
        }
        
        .upload-button:hover {
            background-color: #218838;
        }
        
        .upload-button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        
        .progress-section {
            margin: 30px 0;
            display: none;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: #007bff;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }
        
        .results-section {
            margin-top: 30px;
            display: none;
        }
        
        .file-list {
            list-style: none;
            padding: 0;
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .download-link {
            display: inline-block;
            padding: 8px 16px;
            background-color: #17a2b8;
            color: white;
            text-decoration: none;
            border-radius: 3px;
            transition: background-color 0.3s;
        }
        
        .download-link:hover {
            background-color: #138496;
        }
        
        .download-all-section {
            text-align: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }
        
        .download-all-button {
            display: inline-block;
            padding: 12px 30px;
            background-color: #ffc107;
            color: #212529;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        .download-all-button:hover {
            background-color: #e0a800;
        }
        
        .error-message {
            color: #dc3545;
            text-align: center;
            margin: 20px 0;
            padding: 10px;
            background-color: #f8d7da;
            border-radius: 5px;
        }
        
        .success-message {
            color: #155724;
            text-align: center;
            margin: 20px 0;
            padding: 10px;
            background-color: #d4edda;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¬ å‹•ç”»10åˆ†åˆ†å‰²ãƒ„ãƒ¼ãƒ«</h1>
        
        <div class="upload-section">
            <div class="file-input-wrapper">
                <input type="file" id="videoFile" class="file-input" accept=".mp4,.mov,.avi">
                <label for="videoFile" class="file-input-label">ğŸ“ å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ</label>
            </div>
            <button id="uploadButton" class="upload-button" disabled>ğŸš€ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é–‹å§‹</button>
            <div id="selectedFile" style="margin-top: 10px; color: #666;"></div>
        </div>
        
        <div id="progressSection" class="progress-section">
            <div class="progress-bar">
                <div id="progressFill" class="progress-fill"></div>
            </div>
            <div id="progressText" class="progress-text">å‡¦ç†ä¸­...</div>
        </div>
        
        <div id="errorMessage" class="error-message" style="display: none;"></div>
        <div id="successMessage" class="success-message" style="display: none;"></div>
        
        <div id="resultsSection" class="results-section">
            <h3>ğŸ“‹ åˆ†å‰²ã•ã‚ŒãŸå‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«</h3>
            <ul id="fileList" class="file-list"></ul>
            
            <div class="download-all-section">
                <a id="downloadAllButton" href="#" class="download-all-button">ğŸ“¦ å…¨ãƒ•ã‚¡ã‚¤ãƒ«ä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ (ZIP)</a>
            </div>
        </div>
    </div>

    <script>
        let currentSessionId = null;
        let statusCheckInterval = null;
        
        const videoFileInput = document.getElementById('videoFile');
        const uploadButton = document.getElementById('uploadButton');
        const selectedFileDiv = document.getElementById('selectedFile');
        const progressSection = document.getElementById('progressSection');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const resultsSection = document.getElementById('resultsSection');
        const fileList = document.getElementById('fileList');
        const downloadAllButton = document.getElementById('downloadAllButton');
        const errorMessage = document.getElementById('errorMessage');
        const successMessage = document.getElementById('successMessage');
        
        // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠæ™‚ã®å‡¦ç†
        videoFileInput.addEventListener('change', function() {
            if (this.files.length > 0) {
                const file = this.files[0];
                const fileSize = (file.size / (1024 * 1024 * 1024)).toFixed(2);
                selectedFileDiv.textContent = `é¸æŠã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«: ${file.name} (${fileSize} GB)`;
                uploadButton.disabled = false;
                
                if (file.size > 2 * 1024 * 1024 * 1024) {
                    showError('ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒ2GBã‚’è¶…ãˆã¦ã„ã¾ã™ã€‚');
                    uploadButton.disabled = true;
                }
            } else {
                selectedFileDiv.textContent = '';
                uploadButton.disabled = true;
            }
        });
        
        // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®å‡¦ç†
        uploadButton.addEventListener('click', function() {
            const file = videoFileInput.files[0];
            if (!file) {
                showError('ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            
            uploadFile(file);
        });
        
        function uploadFile(file) {
            const formData = new FormData();
            formData.append('file', file);
            
            // UIçŠ¶æ…‹æ›´æ–°
            uploadButton.disabled = true;
            progressSection.style.display = 'block';
            resultsSection.style.display = 'none';
            hideMessages();
            
            progressText.textContent = 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...';
            progressFill.style.width = '0%';
            
            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.session_id) {
                    currentSessionId = data.session_id;
                    startStatusCheck();
                } else {
                    showError(data.error || 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
                    resetUI();
                }
            })
            .catch(error => {
                showError('ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚');
                resetUI();
            });
        }
        
        function startStatusCheck() {
            statusCheckInterval = setInterval(checkStatus, 2000);
        }
        
        function checkStatus() {
            if (!currentSessionId) return;
            
            fetch(`/status/${currentSessionId}`)
            .then(response => response.json())
            .then(data => {
                if (data.status === 'processing') {
                    progressFill.style.width = data.progress + '%';
                    progressText.textContent = `å‹•ç”»åˆ†å‰²ä¸­... ${data.progress}%`;
                } else if (data.status === 'completed') {
                    clearInterval(statusCheckInterval);
                    progressFill.style.width = '100%';
                    progressText.textContent = 'å‡¦ç†ì™„äº†ï¼';
                    showSuccess('å‹•ç”»ã®åˆ†å‰²ãŒå®Œäº†ã—ã¾ã—ãŸï¼');
                    loadFileList();
                } else if (data.status === 'error') {
                    clearInterval(statusCheckInterval);
                    showError('å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + data.error);
                    resetUI();
                }
            })
            .catch(error => {
                clearInterval(statusCheckInterval);
                showError('ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèªä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚');
                resetUI();
            });
        }
        
        function loadFileList() {
            fetch(`/files/${currentSessionId}`)
            .then(response => response.json())
            .then(data => {
                if (data.files) {
                    displayFileList(data.files);
                    resultsSection.style.display = 'block';
                }
            })
            .catch(error => {
                showError('ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
            });
        }
        
        function displayFileList(files) {
            fileList.innerHTML = '';
            
            files.forEach((filename, index) => {
                const li = document.createElement('li');
                li.className = 'file-item';
                
                const fileInfo = document.createElement('span');
                fileInfo.textContent = `${index + 1}. ${filename}`;
                
                const downloadLink = document.createElement('a');
                downloadLink.href = `/download/${currentSessionId}/${filename}`;
                downloadLink.className = 'download-link';
                downloadLink.textContent = 'ğŸ’¾ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰';
                downloadLink.download = filename;
                
                li.appendChild(fileInfo);
                li.appendChild(downloadLink);
                fileList.appendChild(li);
            });
            
            // ZIPä¸€æ‹¬ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯è¨­å®š
            downloadAllButton.href = `/download_zip/${currentSessionId}`;
        }
        
        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            successMessage.style.display = 'none';
        }
        
        function showSuccess(message) {
            successMessage.textContent = message;
            successMessage.style.display = 'block';
            errorMessage.style.display = 'none';
        }
        
        function hideMessages() {
            errorMessage.style.display = 'none';
            successMessage.style.display = 'none';
        }
        
        function resetUI() {
            uploadButton.disabled = false;
            progressSection.style.display = 'none';
            progressFill.style.width = '0%';
            currentSessionId = null;
        }
    </script>
</body>
</html>
```